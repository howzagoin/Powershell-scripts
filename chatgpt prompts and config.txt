chatgpt remember and always create powershell code that follows all of the below requirements:

    Concise comments with the following fields:
        Author: Name of the script author (e.g., Tim MacLatchy).
        Date: Use the date format dd-MM-yyyy.
        License: Brief MIT license note.
        Description: A concise description of the script's purpose.
        Steps: List the main operations performed by the script.

    Verify all required modules at the start of the script. Install missing modules automatically if necessary.

    Always use ${} delimiters for variable references within strings to avoid parsing errors.

    Wrap all functions with a Log-And-Execute utility to log their execution. Avoid excessive logging for iterative calls within loops.

    Never use deviceauthentication or login via console, use Connect-MgGraph with MFA or -UseWebLogin with MFA for authentication without requiring Azure apps or device authentication. Reuse the session throughout the script to avoid multiple login prompts. Provide clear error messages on authentication failure.

    Use a single progress bar for batch operations (e.g., processing large datasets) to avoid repetitive messages.

    Prompt users for the save location using System.Windows.Forms.SaveFileDialog. Save output in Excel format never csv. named with the pattern tenantname_operation_dd-MM-yyyy.xlsx. Include one worksheet unless otherwise specified. Automatically adjust column widths, include headers. Freeze the header row, make headers bold and word wrap, make every column searchable for filtering and sorting. Export-Excel -Path $FilePath -AutoSize -AutoFilter -FreezeTopRow -BoldTopRow -WrapText

    Implement specific error handling for critical cmdlets to ensure the script handles failures gracefully and provides clear feedback.

    Refactor to reduce redundancy. Use reusable functions for repetitive tasks. never use placeholders like "admin@yourdomain.com" or include example data; prompt users for input if data is required. Wrap all logic into functions, including a Main function, with a clear entry point message.

    Ensure compatibility with both PowerShell Core and PowerShell Desktop editions.

    Infer tenant ID automatically where applicable. For SharePoint, extract the tenant directly from an existing site in the admin portal.

    Use dd-MM-yyyy format consistently throughout.

    After chatgpt suggests changes to a script, chatgpt must Always output the updated whole script, not just the updated part.